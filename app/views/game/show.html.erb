<h2>Start New Game</h2>

<% if flash[:alert] %>
  <p style="color: red;"><%= flash[:alert] %></p>
<% end %>

<%= form_with url: "/new_game", method: :post do %>
  <% 2.times do |i| %>
    <fieldset style="margin-bottom: 12px; padding: 8px; border: 1px solid $444;">
      <legend>Player <%= i + 1 %></legend>

      <div>
        <label>Name</label><br />
        <%= text_field_tag "players[#{i}][name]", (i == 0 ? "Dan" : "Kris") %>
      </div>

      <div style="margin-top: 6px;">
        <label>Faction</label><br />
        <%= select_tag "players[#{i}][faction]", options_for_select(Engine::Catalog::FACTIONS) %>
      </div>

      <div style="margin-top: 6px;">
        <label>Player Mat</label>
        <%= select_tag "players[#{i}][mat]", options_for_select(Engine::Catalog::PLAYER_MATS) %>
      </div>
    </fieldset>
  <% end %>

  <%= submit_tag "Start New Game" %>
<% end %>

<p><strong>Turn:</strong> <%= @turn %></p>
<p><strong>Current Player:</strong> <%= @current_player %></p>
<p><strong>Actions logged:</strong> <%= @action_count %></p>

<%= button_to "End Turn", "/end_turn", method: :post %>

<h2>Players</h2>
<ul>
  <% @players.each_with_index do |p, idx| %>
    <li>
      <strong><%= p["name"] %></strong>
      - <%= p["faction"] %> / <%= p["mat"] %>
      <%= "<<" if idx == @current_player_index %>
      </li>
  <% end %>
</ul>
